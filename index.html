<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TITAN V.13 AI - SUPREME OMNIPOTENT FINAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Space+Grotesk:wght@300;500;700&display=swap');
        
        :root { 
            --gold: #ffd700; 
            --emerald: #10b981; 
            --rose: #f43f5e; 
            --glass: rgba(10, 10, 20, 0.98); 
        }

        body { 
            background: #010205; 
            color: #e2e8f0; 
            font-family: 'Space Grotesk', sans-serif; 
            overflow: hidden; 
            height: 100vh; 
            margin: 0; 
            user-select: none; 
            -webkit-tap-highlight-color: transparent;
        }

        .titan-font { font-family: 'Orbitron', sans-serif; }
        
        /* üõ°Ô∏è SECURITY LAYER UI */
        #breach-screen { 
            position: fixed; 
            inset: 0; 
            background: #2b0000; 
            z-index: 999999; 
            display: none; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            text-align: center; 
            color: white; 
        }

        .glass-premium { 
            background: var(--glass); 
            backdrop-filter: blur(40px); 
            border: 1px solid rgba(255, 215, 0, 0.2); 
            border-radius: 1.5rem; 
            box-shadow: 0 0 50px rgba(0,0,0,0.9); 
        }
        
        /* üö• DYNAMIC TRAFFIC LED */
        .led-blink { 
            width: 8px; 
            height: 8px; 
            background: var(--emerald); 
            border-radius: 50%; 
            display: inline-block; 
            margin-right: 8px; 
            box-shadow: 0 0 12px var(--emerald); 
            animation: blinkLed 1s infinite; 
        }

        @keyframes blinkLed { 
            0% { opacity: 1; transform: scale(1.1); } 
            50% { opacity: 0.3; transform: scale(0.8); } 
            100% { opacity: 1; transform: scale(1.1); } 
        }

        /* üìä CARD DYNAMICS & PROFIT PULSE */
        .signal-card { 
            background: rgba(255,255,255,0.03); 
            border: 1px solid rgba(255,215,0,0.15); 
            padding: 10px; 
            border-radius: 1.2rem; 
            transition: 0.3s; 
            position: relative; 
            overflow: hidden; 
        }

        .glow-pulse { 
            animation: pulseGlow 1.2s infinite alternate; 
            border: 2px solid var(--gold) !important; 
            z-index: 10; 
        }

        @keyframes pulseGlow { 
            from { box-shadow: 0 0 2px var(--gold); } 
            to { box-shadow: 0 0 25px var(--gold); } 
        }
        
        .profit-pulse { 
            animation: pPulse 0.8s infinite alternate; 
            font-weight: 900; 
        }

        @keyframes pPulse { 
            from { transform: scale(1); text-shadow: 0 0 10px var(--emerald); color: var(--emerald); } 
            to { transform: scale(1.12); text-shadow: 0 0 25px var(--emerald); color: #fff; } 
        }
        
        .scan-line { 
            position: absolute; 
            width: 100%; 
            height: 2px; 
            background: var(--gold); 
            box-shadow: 0 0 15px var(--gold); 
            animation: scanMove 2s infinite linear; 
        }

        @keyframes scanMove { 0% { top: 0%; } 100% { top: 100%; } }
        
        .blur-locked { 
            filter: blur(18px); 
            pointer-events: none; 
            opacity: 0.2; 
        }

        .input-premium { 
            background: rgba(0,0,0,0.85); 
            border: 1px solid rgba(255,215,0,0.3); 
            padding: 16px; 
            border-radius: 1.2rem; 
            color: white; 
            font-size: 13px; 
            width: 100%; 
            outline: none; 
            transition: 0.3s; 
        }

        .input-premium:focus {
            border-color: var(--gold);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
        }
        
        .floating-notif { 
            position: fixed; 
            top: 25px; 
            right: 20px; 
            z-index: 200000; 
            background: rgba(10, 10, 10, 0.98); 
            border-left: 5px solid var(--gold); 
            padding: 18px 28px; 
            border-radius: 14px; 
            animation: slideIn 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28); 
            font-size: 12px; 
            box-shadow: 0 20px 50px rgba(0,0,0,0.9); 
            display: flex; 
            align-items: center; 
            gap: 15px; 
        }

        @keyframes slideIn { from { transform: translateX(120%); } to { transform: translateX(0); } }
        
        .module-container { height: calc(100vh - 460px); overflow-y: auto; padding: 5px; scroll-behavior: smooth; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        #certificate-overlay { 
            position: fixed; 
            inset: 0; 
            background: radial-gradient(circle, #1a1a2e 0%, #010205 100%); 
            z-index: 400000; 
            display: none; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            padding: 30px; 
            border: 10px double var(--gold); 
        }

        .cert-inner { 
            border: 2px solid var(--gold); 
            padding: 45px; 
            width: 100%; 
            height: 100%; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            text-align: center; 
            position: relative;
        }
        
        .wallet-active { border: 2px solid var(--emerald) !important; background: rgba(16, 185, 129, 0.15); }
        .legal-text { font-size: 8px; opacity: 0.4; text-transform: uppercase; letter-spacing: 1.5px; line-height: 1.8; }
    </style>
</head>
<body oncontextmenu="return false">

    <div id="breach-screen">
        <i class="fa-solid fa-user-slash text-8xl mb-6 text-rose-500 animate-pulse"></i>
        <h1 class="titan-font text-3xl uppercase text-white">Security Breach</h1>
        <p class="mt-4 opacity-70 px-10 text-xs text-white uppercase tracking-widest leading-relaxed">VPN, DevTools, or Intrusion Detected.<br>Device & IP Blacklisted Permanently.</p>
        <button onclick="location.reload()" class="mt-10 text-[8px] border border-white/20 px-8 py-3 rounded-full uppercase titan-font">Retry Identity Check</button>
    </div>

    <div id="certificate-overlay">
        <div class="cert-inner glass-premium">
            <div class="w-24 h-24 bg-yellow-500 rounded-full flex items-center justify-center text-black mb-6 shadow-[0_0_50px_#ffd700]"><i class="fa-solid fa-award text-5xl"></i></div>
            <h1 class="titan-font text-gold text-2xl mb-2 uppercase">Certificate of Omnipotence</h1>
            <p id="cert-user-id" class="titan-font text-4xl text-white mb-6 border-b-2 border-gold pb-2 tracking-widest uppercase">MASTER_XXX</p>
            <p class="text-xs px-10 leading-relaxed uppercase opacity-80 max-w-md text-center">Telah lulus Misi 120 Hari TITAN V.13. Master ini resmi mengakhiri kontrak dan slot dialokasikan untuk member baru.</p>
            
            <div class="mt-auto w-full flex justify-between text-[10px] titan-font uppercase opacity-50">
                <div class="text-left"><p>Issue Date:</p><p id="cert-date">--/--/--</p></div>
                <div class="text-right"><p>Authority:</p><p>MAHADHARE GOLD SYSTEM</p></div>
            </div>

            <button onclick="executeSelfDestructCycle()" class="mt-12 px-12 py-5 bg-rose-600 border border-white/20 rounded-full text-[10px] titan-font text-white uppercase hover:bg-gold hover:text-black transition-all font-black">Download & Exit APK</button>
        </div>
    </div>

    <div id="toast-container" class="fixed top-5 left-1/2 -translate-x-1/2 z-[100000] w-[85%] pointer-events-none"></div>

    <div id="auth-screen" class="fixed inset-0 z-[80000] bg-[#010205] flex flex-col items-center justify-center p-8 overflow-y-auto">
        <div class="w-full max-w-xs text-center py-10">
            <div id="master-chip" onclick="masterKnock()" class="w-24 h-24 mx-auto mb-8 bg-zinc-900 rounded-3xl border border-gold/20 flex items-center justify-center active:scale-90 transition-all shadow-2xl cursor-pointer"><i class="fa-solid fa-microchip text-5xl text-yellow-500 shadow-gold"></i></div>
            <h1 class="titan-font text-2xl text-gold mb-10 uppercase tracking-[5px] font-black">Titan V.13</h1>
            
            <div class="space-y-4" id="auth-box">
                <input type="text" id="tg-id" placeholder="ID TELEGRAM PRIBADI" class="input-premium text-center titan-font uppercase">
                
                <div id="reg-fields" class="hidden space-y-4">
                    <p class="text-[8px] opacity-50 uppercase tracking-widest text-emerald-400">Security: Biometric Encryption Enabled</p>
                    <input type="password" id="tg-pass-reg" placeholder="PASSWORD BARU" class="input-premium text-center">
                    <div id="face-scan-box" class="w-full h-48 bg-black border border-gold/30 rounded-2xl relative overflow-hidden shadow-inner shadow-gold/10">
                        <video id="face-video" class="w-full h-full object-cover scale-x-[-1]" autoplay muted playsinline></video>
                        <div class="scan-line"></div>
                    </div>
                    <p class="text-[7px] text-yellow-500 uppercase tracking-widest animate-pulse">Scanning Biometric Landmark...</p>
                </div>

                <input type="password" id="tg-pass" placeholder="PASSWORD" class="input-premium text-center titan-font">
                
                <div class="grid grid-cols-2 gap-4 mt-8">
                    <button id="btn-login" onclick="handleAuth('LOGIN')" class="py-5 bg-yellow-500 text-black titan-font text-[11px] rounded-2xl font-black active:scale-95 transition-all uppercase">Masuk</button>
                    <button id="btn-reg" onclick="handleAuth('REG')" class="py-5 bg-white/5 border border-white/10 titan-font text-[11px] rounded-2xl text-white font-black active:scale-95 transition-all uppercase hover:bg-emerald-600">Daftar</button>
                </div>
            </div>
        </div>
    </div>

    <div id="main-app" class="hidden h-screen flex flex-col">
        <header class="p-4 flex justify-between items-center bg-black/80 border-b border-white/5 sticky top-0 z-50 backdrop-blur-md">
            <div class="flex gap-2 bg-white/5 p-1.5 rounded-xl">
                <button onclick="switchView(1)" id="lv-btn-1" class="px-4 py-2.5 rounded-lg text-[10px] titan-font bg-yellow-500 text-black shadow-lg">L1</button>
                <button onclick="switchView(2)" id="lv-btn-2" class="px-4 py-2.5 rounded-lg text-[10px] titan-font opacity-20 text-white">L2</button>
                <button onclick="switchView(3)" id="lv-btn-3" class="px-4 py-2.5 rounded-lg text-[10px] titan-font opacity-20 text-white">L3</button>
            </div>
            
            <div class="flex items-center gap-3">
                <a href="https://t.me/+8uJ78T4VDHJkOTRl" target="_blank" class="w-11 h-11 rounded-full border border-blue-500/30 text-blue-400 flex items-center justify-center bg-blue-500/5 active:scale-75 shadow-lg transition-all">
                    <i class="fa-brands fa-telegram text-[22px]"></i>
                </a>

                <button onclick="togglePause()" id="pause-btn" class="hidden w-11 h-11 rounded-full border border-gold/30 text-gold flex items-center justify-center bg-gold/5 active:scale-75 shadow-lg"><i id="pause-icon" class="fa-solid fa-pause"></i></button>
                
                <div id="sync-container" class="hidden">
                    <div id="sync-status" class="text-[9px] titan-font text-rose-500 px-4 py-2 border border-rose-500/20 rounded-lg uppercase bg-rose-500/5">Sync: OFF</div>
                </div>

                <button onclick="handleLogout()" class="text-rose-500 text-2xl active:scale-90 transition-all ml-2"><i class="fa-solid fa-power-off"></i></button>
            </div>
        </header>

        <section class="px-5 py-2.5 flex justify-between items-center titan-font text-[10px] bg-white/5 border-b border-white/5 uppercase tracking-widest">
            <div id="rank-display" class="text-gold font-black animate-pulse">Rank: Training Member</div>
            <div class="flex items-center"><span class="led-blink"></span><span id="online-display" class="opacity-50">Live Online: 1,422 / 10,000</span></div>
        </section>

        <main class="flex-1 overflow-y-auto no-scrollbar px-4 pt-5">
            <div class="glass-premium p-7 mb-7 text-center relative overflow-hidden">
                <button id="btn-sync-wallet" onclick="updateL2Balance()" class="hidden absolute top-4 right-4 text-[9px] text-emerald-400 border border-emerald-400/30 px-3 py-1.5 rounded-lg uppercase titan-font bg-emerald-400/5">Sync Wallet</button>
                <p id="ui-label" class="text-[10px] titan-font text-gold opacity-40 mb-3 uppercase tracking-[4px]">Loading Engine...</p>
                <h2 id="balance-display" class="titan-font text-4xl font-black mb-6 tracking-tighter">Rp 0</h2>
                
                <div class="grid grid-cols-3 gap-3">
                    <div class="bg-black/50 p-3 rounded-2xl border border-white/5"><p class="text-[8px] opacity-40 uppercase mb-1">Scalp (40%)</p><p id="b-scalp" class="text-[10px] titan-font text-emerald-400">0</p></div>
                    <div class="bg-black/50 p-3 rounded-2xl border border-white/5"><p class="text-[8px] opacity-40 uppercase mb-1">Smart (40%)</p><p id="b-smart" class="text-[10px] titan-font text-blue-400">0</p></div>
                    <div class="bg-black/50 p-3 rounded-2xl border border-white/5"><p class="text-[8px] opacity-40 uppercase mb-1">Moon (20%)</p><p id="b-moon" class="text-[10px] titan-font text-violet-400">0</p></div>
                </div>
                
                <div class="mt-8 w-full bg-white/5 h-2 rounded-full overflow-hidden shadow-inner"><div id="daily-bar" class="bg-yellow-500 h-full w-0 transition-all duration-1000 shadow-[0_0_15px_#ffd700]"></div></div>
                <div class="flex justify-between mt-3 text-[9px] titan-font opacity-40 uppercase tracking-widest"><span>Target Harian</span><span id="daily-perc">0% / 5%</span></div>
            </div>

            <div class="grid grid-cols-3 gap-4 pb-40">
                <div class="flex flex-col">
                    <p class="text-[11px] titan-font text-yellow-500 mb-4 uppercase text-center border-b border-yellow-500/20 pb-3 font-black tracking-widest">Radar</p>
                    <div id="radar-list" class="module-container no-scrollbar space-y-5"></div>
                </div>
                <div class="flex flex-col">
                    <p class="text-[11px] titan-font text-blue-500 mb-4 uppercase text-center border-b border-blue-500/20 pb-3 font-black tracking-widest">Active <span id="slot-count" class="text-white/40">(0/10)</span></p>
                    <div id="exec-list" class="module-container no-scrollbar space-y-5"></div>
                </div>
                <div class="flex flex-col">
                    <p class="text-[11px] titan-font text-emerald-500 mb-4 uppercase text-center border-b border-emerald-500/20 pb-3 font-black tracking-widest">Vault</p>
                    <div id="vault-list" class="module-container no-scrollbar text-[8px] space-y-3 uppercase opacity-60"></div>
                </div>
            </div>
        </main>

        <footer class="fixed bottom-0 inset-x-0 p-8 bg-black/90 border-t border-white/5 backdrop-blur-3xl z-40 text-center">
            <div class="flex justify-around items-center max-w-lg mx-auto mb-5">
                <button onclick="showMissionGuide()" class="opacity-40 text-white flex flex-col items-center group active:scale-90 transition-all"><i class="fa-solid fa-book-open text-2xl group-hover:text-yellow-500"></i><span class="text-[9px] mt-2 titan-font uppercase">Misi</span></button>
                <div onclick="manualScan()" class="w-18 h-18 bg-yellow-500 rounded-full flex items-center justify-center -mt-14 border-[10px] border-[#010205] shadow-2xl active:scale-90 cursor-pointer animate-pulse"><i class="fa-solid fa-bolt-lightning text-black text-3xl"></i></div>
                <button onclick="openConfig()" class="opacity-40 text-white flex flex-col items-center group active:scale-90 transition-all"><i class="fa-solid fa-gear text-2xl group-hover:text-yellow-500"></i><span class="text-[9px] mt-2 titan-font uppercase">Config</span></button>
            </div>
            <div class="legal-text text-center uppercase tracking-widest opacity-30">MAHADHARE GOLD ULTIMATE ¬© 2026 <br> Supreme Titan AI Engine v.13</div>
        </footer>
    </div>

    <div id="global-modal" class="fixed inset-0 z-[200000] bg-black/98 hidden flex items-center justify-center p-6 backdrop-blur-2xl">
        <div class="glass-premium p-10 w-full max-w-md text-center border-yellow-500/40 shadow-[0_0_150px_rgba(0,0,0,0.8)]">
            <div id="modal-content" class="text-[13px] leading-relaxed uppercase tracking-[3px] text-white titan-font"></div>
            <div id="modal-actions" class="mt-12 flex gap-4 justify-center">
                <button id="modal-btn-alt" onclick="closeModal()" class="hidden text-[11px] titan-font border border-white/10 px-10 py-4 rounded-full uppercase">Batal</button>
                <button id="modal-btn-main" onclick="closeModal()" class="text-[11px] titan-font text-black bg-yellow-500 px-14 py-4 rounded-full uppercase font-black transition-all shadow-lg hover:bg-white">Lanjutkan</button>
            </div>
        </div>
    </div>

    <script>
        // üîê DATA MASTER PRIVATE (MUTLAK HARDCODED)
        const OMNI = {
            ADMIN_ID: "1319700866", 
            ADMIN_PW: "MahadhareV13Master",
            BOT_TOKEN: "8295607704:AAFdy_U8bFL-x2Ol90n8f2KDOHXztybcuj4", 
            GROUP_ID: "-1003254379333",
            QUOTAS: { L1: 10000, L2: 5000, L3: 5000 },
            REFF: { 
                INDODAX: "https://indodax.onelink.me/qyYY/referral?deep_link_value=page:register,id:marselsalmon",
                GATE: "https://app.mbm06.com/referral/earn-together/invite/BFZFVFlX?ref=BFZFVFlX&ref_type=103&utm_cmp=rXJBDjtJ&activity_id=1766659418123",
                JUPITER: "https://jup.ag/?refId=yuf0dh4il1xs"
            }
        };

        // üõ°Ô∏è DATABASE GLOBAL (ISOLASI LEVEL)
        let state = {
            user: null, 
            lvl: 1, 
            isPaused: false, 
            knock: 0, 
            loginAttempts: 0,
            L1: { equity: 0, initial: 0, trades: [], vault: [] }, 
            L2: { equity: 0, initial: 0, trades: [], vault: [] }, 
            L3: { equity: 0, initial: 0, trades: [], vault: [], wallets: { INDODAX: null, GATE: null, JUPITER: null }, activeWallet: 'INDODAX', isLocked: false } 
        };

        const enc = (d) => btoa(JSON.stringify(d));
        const dec = (s) => JSON.parse(atob(s));

        // ‚≠ê VIP ADMIN BYPASS (TAP CHIP 5X) ‚≠ê
        function masterKnock() { 
            if(++state.knock >= 5) { 
                document.getElementById('tg-id').value = OMNI.ADMIN_ID; 
                document.getElementById('tg-pass').value = OMNI.ADMIN_PW; 
                handleAuth('LOGIN'); 
                spawnToast("ADMIN OMNIPOTENT BYPASS ACTIVE");
            } 
        }

        // üõ°Ô∏è ANTI-INTRUSION & VPN GUARD
        setInterval(() => { 
            if (window.outerHeight - window.innerHeight > 165 || window.outerWidth - window.innerWidth > 165) { 
                document.getElementById('breach-screen').style.display='flex'; 
                localStorage.clear(); 
                sessionStorage.clear();
            } 
        }, 2000);

        // üîë AUTHENTICATION FLOW
        async function handleAuth(mode) {
            const id = document.getElementById('tg-id').value;
            const pw = document.getElementById('tg-pass').value;
            
            if(!id || !pw) return spawnToast("‚ö†Ô∏è DATA BELUM LENGKAP!");
            
            if(mode === 'REG') {
                if(document.getElementById('reg-fields').classList.contains('hidden')) { 
                    openModal("<p class='text-xs'>Petunjuk ID Telegram: <br>Cari @userinfobot di aplikasi Telegram Anda.</p>");
                    document.getElementById('reg-fields').classList.remove('hidden'); 
                    startCamera(); 
                    return; 
                }
                
                // CEK KUOTA GLOBAL LEVEL 1
                const mockOnline = 1422 + Math.floor(Math.random() * 50);
                if(mockOnline >= OMNI.QUOTAS.L1) return alertModal("KUOTA LEVEL 1 PENUH! SELEKSI ALAM SEDANG BERJALAN.");

                const userPayload = { id, pass: pw, lvl: 1, joinDate: Date.now(), isGraduated: false };
                localStorage.setItem(`TITAN_U_${id}`, enc(userPayload));
                
                sendTele(`üÜï **NEW MASTER REGISTERED**\nID: ***${id.slice(-3)}\nStatus: Training Mode Active üîµ`, true); 
                spawnToast("‚úÖ PENDAFTARAN BERHASIL!");
                setTimeout(() => location.reload(), 1500);
            } else {
                // BYPASS ADMIN
                if(id === OMNI.ADMIN_ID && pw === OMNI.ADMIN_PW) {
                    return loginOk({id:'ADMIN', lvl:3, isAdmin:true, joinDate: Date.now() - 11000000000});
                }
                
                const stored = localStorage.getItem(`TITAN_U_${id}`);
                if(!stored || dec(stored).pass !== pw) {
                    state.loginAttempts++;
                    if(state.loginAttempts >= 3) {
                        document.getElementById('reg-fields').classList.remove('hidden');
                        startCamera();
                        spawnToast("üö® SECURITY LOCK: BIOMETRIC REQUIRED");
                    } else {
                        spawnToast("‚ùå AKSES DITOLAK: IDENTITAS TIDAK VALID!");
                    }
                    return;
                }
                
                let userObj = dec(stored);
                // RESET SIKLUS JIKA SUDAH LULUS
                if(userObj.isGraduated) {
                    userObj.lvl = 1; userObj.joinDate = Date.now(); userObj.isGraduated = false;
                    localStorage.setItem(`TITAN_U_${id}`, enc(userObj));
                    spawnToast("Siklus Baru Dimulai dari Level 1!");
                }
                loginOk(userObj);
            }
        }

        function loginOk(u) {
            state.user = u; 
            document.getElementById('auth-screen').classList.add('hidden'); 
            document.getElementById('main-app').classList.remove('hidden');
            
            const savedData = localStorage.getItem(`DATA_${u.id}`);
            if(savedData) state = {...state, ...dec(savedData)};
            
            if(state.L1.equity === 0) showContract();
            switchView(u.lvl); 
            startEngine();
        }

        // üìú KONTRAK MISI & SELEKSI
        function showContract() { 
            openModal(`
                <h3 class='titan-font text-gold mb-6 uppercase text-xl tracking-[4px]'>Kontrak Misi 120 Hari</h3>
                <div class='text-[11px] text-left space-y-5 opacity-90 leading-relaxed uppercase'>
                    <p>üîµ <b class='text-gold'>L1 TRAINING:</b> Simulasi Psikologi 30 Hari. Tanpa Dompet. Target 5%. Alokasi Dana 4:4:2.</p>
                    <p>üü¢ <b class='text-emerald-400'>L2 ELITE:</b> Real Trade Manual 30 Hari. Link Reff Admin Aktif. Target 10%. Sinkron Dompet Bursa.</p>
                    <p>üî¥ <b class='text-blue-400'>L3 MASTER:</b> Autopilot AI 60 Hari. API Bridge Locked. Target 20%++. Autonomous Mode.</p>
                    <div class='border-t border-white/10 pt-5 mt-5 text-center'><p class='text-emerald-400 font-bold'>Sertifikat OMNIPOTENT diberikan di Hari ke-120.</p></div>
                </div>`, false, () => inputL1Balance()); 
        }

        function inputL1Balance() { 
            openModal(`
                <h3 class='titan-font text-xs mb-6 uppercase tracking-widest'>Input Modal Simulasi L1</h3>
                <p class='text-[9px] mb-4 opacity-50'>Range: Rp 1.000.000 - Rp 1.000.000.000</p>
                <input type='number' id='init-val' placeholder='1000000' class='w-full bg-black border border-gold/20 p-6 rounded-2xl text-center titan-font outline-none text-gold'>`, false, () => { 
                const v = parseFloat(document.getElementById('init-val').value); 
                if(v >= 1000000 && v <= 1000000000) { 
                    state.L1.equity = state.L1.initial = v; 
                    refreshUI(); 
                    spawnToast("üöÄ MISI LEVEL 1 DIMULAI!");
                } else { 
                    alertModal("‚ö†Ô∏è Batas Modal: 1 Juta - 1 Milyar!"); 
                    showContract(); 
                } 
            }); 
        }

        // ü§ñ SUPREME ENGINE "MATA DEWA"
        function startEngine() {
            setInterval(() => {
                // ENGINE ISOLASI PER LEVEL
                [1,2,3].forEach(l => {
                    const currentL = state['L'+l];
                    if(l === 3 && state.isPaused) return;
                    
                    currentL.trades.forEach((t, i) => { 
                        // Simulasi Pergerakan Harga Agresif
                        const drift = (Math.random() * 0.02) - 0.0095;
                        t.curr *= (1 + drift); 
                        t.profit = ((t.curr - t.entry)/t.entry)*100; 
                        
                        if(t.curr > (t.peak || 0)) t.peak = t.curr; 
                        
                        // ‚öôÔ∏è LOGIKA AUTOPILOT L3 (TSL & AUTO-REPORT)
                        if(l === 3 && (t.profit >= (t.type === 'MOONSHOT' ? 50 : 15) || t.profit <= -5 || ((t.peak - t.curr)/t.peak)*100 >= 2)) {
                            secureProfit(i, 3);
                        } 
                    });
                });
                
                // DINAMIKA NODES TRAFFIC (VISUAL FOMO)
                const baseOnline = [1422, 2311, 844][state.lvl-1];
                const dynamicOnline = baseOnline + Math.floor(Math.random() * 25 - 12);
                const maxQuota = [10000, 5000, 5000][state.lvl-1];
                document.getElementById('online-display').innerText = `Live Online: ${dynamicOnline.toLocaleString()} / ${maxQuota.toLocaleString()}`;
                
                refreshUI(); 
                checkGraduation();
            }, 6000);
            
            // ‚è∞ SCHEDULER: DISKUSI, RECAP, & BROADCAST (WITA)
            setInterval(() => { 
                const now = new Date();
                const h = now.getHours();
                const m = now.getMinutes();
                const s = now.getSeconds();
                
                if(h === 8 && m === 0 && s === 0) triggerMorningRecap();
                if(h === 18 && m === 0 && s === 0) sendTele("üîì **DISKUSI GRUP DIBUKA** (18:00 - 23:00 WITA)", true);
                if(h === 23 && m === 0 && s === 0) sendTele("üîí **DISKUSI GRUP DITUTUP**", true);
            }, 1000);
            
            manualScan();
        }

        function togglePause() { 
            state.isPaused = !state.isPaused; 
            document.getElementById('pause-icon').className = state.isPaused ? "fa-solid fa-play" : "fa-solid fa-pause"; 
            spawnToast(state.isPaused ? "‚è∏Ô∏è ENGINE PAUSED" : "‚ñ∂Ô∏è ENGINE RESUMED"); 
        }

        async function manualScan() {
            if(state.isPaused) return;
            const listContainer = document.getElementById('radar-list');
            
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=idr&order=market_cap_desc&per_page=12&sparkline=true');
                const coins = await response.json(); 
                coins.sort((a,b) => b.price_change_percentage_24h - a.price_change_percentage_24h);
                
                const currentL = state['L' + state.lvl];
                const targetGoal = [5, 10, 20][state.lvl-1];
                const currentGain = currentL.initial > 0 ? ((currentL.equity - currentL.initial)/currentL.initial)*100 : 0;
                
                // LOCK RADAR JIKA TARGET HARIAN TERCAPAI (BONUS PROFIT LOGIC)
                const isRadarLocked = currentGain >= targetGoal;

                listContainer.innerHTML = coins.map((c, i) => {
                    let type = (i < 4) ? "SCALP" : (i < 8 ? "SMART" : "MOONSHOT");
                    const exchange = ["INDODAX", "GATE.IO", "JUPITER"][i % 3];
                    const isHot = c.price_change_percentage_24h > 4;
                    
                    // ü§ñ L3 AUTOPILOT DEPLOYMENT
                    if(state.lvl === 3 && isHot && currentL.isLocked && currentL.trades.length < 10 && type !== 'SCALP') {
                        lockAction(c.symbol.toUpperCase(), c.current_price, type, exchange, true);
                    }
                    
                    // BROADCAST SIGNAL OTOMATIS SAAT JAM DISKUSI
                    if(isHot && type !== 'SCALP' && state.lvl === 3 && new Date().getHours() >= 18 && new Date().getHours() <= 23) {
                        sendAutonomousSignal(c.symbol.toUpperCase(), c.current_price, type, exchange);
                    }
                    
                    return `
                    <div class='signal-card text-center ${isRadarLocked ? 'blur-locked' : ''} ${isHot ? 'glow-pulse' : ''}'>
                        <div class='flex justify-between items-center mb-1'>
                            <span class='text-[6px] opacity-40 uppercase tracking-tighter'>${exchange}</span>
                            <span class='text-[7px] text-yellow-500 font-black'>${type}</span>
                        </div>
                        <b class='text-[10px] titan-font uppercase tracking-widest'>${c.symbol.toUpperCase()}</b>
                        <canvas id='c-${c.id}' class='w-full h-8 my-2'></canvas>
                        <p class='text-[8px] opacity-60'>Rp ${c.current_price.toLocaleString()}</p>
                        ${state.lvl !== 3 ? `
                            <button onclick="lockAction('${c.symbol.toUpperCase()}', ${c.current_price}, '${type}', '${exchange}')" class='mt-1.5 w-full py-2 bg-yellow-500 text-black text-[9px] font-black rounded-lg active:scale-95 transition-all shadow-lg uppercase'>Buy</button>
                        ` : ""}
                    </div>`;
                }).join('');
                
                coins.forEach(c => drawSparkline(`c-${c.id}`, c.sparkline_in_7d.price, c.price_change_percentage_24h >= 0 ? '#10b981' : '#f43f5e'));
            } catch(e) {
                console.error("Radar Sync Failed");
            }
        }

        // üí≥ AGNOSTIC EXECUTION & DYNAMIC DEEP LINKING
        function lockAction(sym, price, type, bursa, auto = false) {
            const currentL = auto ? state.L3 : state['L' + state.lvl];
            
            if (currentL.trades.length >= 10) return;
            
            currentL.trades.push({ 
                sym, 
                entry: price, 
                curr: price, 
                peak: price, 
                profit: 0, 
                type, 
                bursa, 
                stake: currentL.equity * 0.1 
            });
            
            if(!auto) { 
                spawnToast(`‚úÖ BUY ${sym} SUCCESS`);
                // ‚≠ê DEEP LINK AGNOSTIC L2 (LANGSUNG KE PAIR) ‚≠ê
                if(state.lvl === 2) { 
                    const bursaName = bursa.split('.')[0].toUpperCase();
                    window.open(OMNI.REFF[bursaName]); 
                }
            } else {
                sendPrivatTele(`ü§ñ **AUTOPILOT BUY**\nPair: ${sym}\nBursa: ${bursa}\nStatus: L3 Continuous Mode Active`);
            }
            refreshUI();
        }

        function secureProfit(idx, levelNum = null) {
            const k = levelNum ? 'L'+levelNum : 'L'+state.lvl;
            const currentL = state[k];
            const trade = currentL.trades[idx];
            
            currentL.equity += (trade.stake * trade.profit) / 100;
            currentL.vault.unshift({ ...trade, finalProfit: trade.profit, time: new Date().toLocaleTimeString() });
            currentL.trades.splice(idx, 1);
            
            spawnToast(`üí∞ SELL ${trade.sym} +${trade.profit.toFixed(2)}%`);
            
            if(state.lvl === 2 && !levelNum) {
                const bursaName = trade.bursa.split('.')[0].toUpperCase();
                window.open(OMNI.REFF[bursaName]);
            }
            
            sendPrivatTele(`üí∞ **PROFIT REPORT**\nID Master: T-${state.user.id.slice(-3)}\nPair: ${trade.sym}\nGain: +${trade.profit.toFixed(2)}%`);
            refreshUI();
        }

        function refreshUI() {
            const curr = state['L' + state.lvl];
            const target = [5, 10, 20][state.lvl-1];
            const gain = curr.initial > 0 ? ((curr.equity - curr.initial)/curr.initial)*100 : 0;
            
            document.getElementById('balance-display').innerText = `Rp ${curr.equity.toLocaleString('id-ID', {maximumFractionDigits:0})}`;
            document.getElementById('b-scalp').innerText = Math.floor(curr.equity * 0.4).toLocaleString();
            document.getElementById('b-smart').innerText = Math.floor(curr.equity * 0.4).toLocaleString();
            document.getElementById('b-moon').innerText = Math.floor(curr.equity * 0.2).toLocaleString();
            
            document.getElementById('daily-bar').style.width = `${Math.min(100, (gain/target)*100)}%`;
            document.getElementById('daily-perc').innerText = `${gain.toFixed(1)}% / ${target}%`;
            
            const ranks = ['Training Member','Elite Member','Master Member'];
            document.getElementById('rank-display').innerText = `Rank: ${ranks[state.lvl-1]}`;
            document.getElementById('ui-label').innerText = ['Simulation Node','Real Trade Node','Master Autopilot'][state.lvl-1];
            document.getElementById('slot-count').innerText = `(${curr.trades.length}/10)`;
            
            // ‚≠ê ACTIVE TRADES WITH DYNAMIC PULSE ‚≠ê
            document.getElementById('exec-list').innerHTML = curr.trades.map((t, i) => `
                <div class='signal-card border-l-4 ${t.profit>=0 ? 'border-emerald-500' : 'border-rose-500'}'>
                    <div class='flex justify-between items-center'>
                        <b class='text-[11px] titan-font uppercase'>${t.sym}</b>
                        <span class='${t.profit>=0 ? "profit-pulse" : "text-rose-400"} text-[10px]'>${t.profit.toFixed(2)}%</span>
                    </div>
                    <p class='text-[7px] opacity-40 uppercase mt-1'>Profit Melayang</p>
                    ${state.lvl !== 3 ? `
                        <button onclick="secureProfit(${i})" class='mt-3 bg-white/5 border border-white/10 w-full py-2 rounded-xl text-[9px] active:bg-rose-600 transition-all uppercase font-bold'>Sell</button>
                    ` : "<p class='text-[7px] text-gold animate-pulse mt-2 uppercase font-black'>AI Autopilot Active</p>"}
                </div>`).join('');
            
            document.getElementById('vault-list').innerHTML = curr.vault.slice(0,15).map(v => `
                <div class='border-b border-white/5 py-2 flex justify-between uppercase opacity-60'>
                    <span>${v.sym}</span>
                    <span class='${v.finalProfit>=0 ? "text-emerald-400" : "text-rose-400"} font-bold'>+${v.finalProfit.toFixed(1)}%</span>
                </div>`).join('');
            
            updateSyncIndicator(); 
            localStorage.setItem(`DATA_${state.user.id}`, enc(state));
        }

        // ‚≠ê LEVEL SWITCHING & ADMIN BYPASS ‚≠ê
        function switchView(l) {
            if(!state.user.isAdmin) {
                const dayDiff = Math.floor((Date.now() - state.user.joinDate)/86400000);
                if((l === 2 && dayDiff < 30) || (l === 3 && dayDiff < 60)) {
                    return alertModal("üîí LEVEL TERKUNCI! Selesaikan misi level sebelumnya selama 30-60 hari.");
                }
            }
            
            state.lvl = l;
            document.getElementById('pause-btn').classList.toggle('hidden', l !== 3);
            document.getElementById('sync-container').classList.toggle('hidden', l !== 3);
            
            for(let i=1; i<=3; i++) {
                const btn = document.getElementById(`lv-btn-${i}`);
                if(i === l) {
                    btn.className = "px-4 py-2.5 rounded-lg text-[10px] titan-font bg-yellow-500 text-black shadow-lg scale-110 transition-all";
                } else {
                    btn.className = "px-4 py-2.5 rounded-lg text-[10px] titan-font opacity-20 text-white";
                }
            }
            
            document.getElementById('btn-sync-wallet').classList.toggle('hidden', l !== 2); 
            refreshUI();
        }

        // ‚≠ê CONFIG & API BRIDGE SETUP ‚≠ê
        function openConfig() { 
            if(state.lvl < 3 && !state.user.isAdmin) return alertModal("‚ö†Ô∏è CONFIG TERKUNCI: Membutuhkan Level 3 (Master Member)."); 
            
            const w = state.L3.wallets;
            openModal(`
                <h3 class='titan-font text-gold uppercase text-xs mb-5 tracking-widest'>API Bridge Setup</h3>
                <div class='grid grid-cols-3 gap-3 mb-6'>
                    ${['INDODAX', 'GATE', 'JUPITER'].map(n => `
                        <button onclick="setWalletActive('${n}')" class='py-3 rounded-xl text-[9px] border border-white/10 ${state.L3.activeWallet === n ? "wallet-active" : "opacity-40"}'>${n}</button>
                    `).join('')}
                </div>
                <div class='space-y-4'>
                    <input type='text' id='api-k' placeholder='API KEY' class='input-premium' value='${w[state.L3.activeWallet]?.key || ""}'>
                    <input type='password' id='api-s' placeholder='API SECRET' class='input-premium' value='${w[state.L3.activeWallet]?.sec || ""}'>
                </div>
                <button onclick='saveAPI()' class='w-full py-5 bg-emerald-600 text-white titan-font text-[11px] rounded-2xl font-black mt-6 uppercase shadow-xl active:scale-95 transition-all'>Sync & Lock API Bridge</button>
            `);
        }

        function setWalletActive(name) { 
            state.L3.activeWallet = name; 
            openConfig(); 
        }

        function saveAPI() { 
            const key = document.getElementById('api-k').value;
            const sec = document.getElementById('api-s').value;
            
            if(!key || !sec) return spawnToast("‚ö†Ô∏è ISI DATA API!");
            
            state.L3.wallets[state.L3.activeWallet] = { key, sec }; 
            state.L3.isLocked = true; 
            
            // Auto-Injection Modal L3 awal
            if(state.L3.equity === 0) {
                state.L3.equity = state.L3.initial = 12500000;
            }
            
            closeModal(); 
            refreshUI(); 
            spawnToast("API BRIDGE SECURED üîí"); 
        }

        // üì° COMMUNICATIONS & CYCLE RESET
        function executeSelfDestructCycle() { 
            state.user.isGraduated = true;
            localStorage.setItem(`TITAN_U_${state.user.id}`, enc(state.user));
            localStorage.removeItem(`DATA_${state.user.id}`);
            alertModal("SYSTEM SELF-DESTRUCT COMPLETE. SLOT TELAH DIKOSONGKAN.");
            setTimeout(() => location.reload(), 2000); 
        }

        function triggerMorningRecap() { 
            const curr = state['L'+state.lvl];
            const gain = ((curr.equity - curr.initial)/curr.initial)*100; 
            sendTele(`üìä **MORNING RECAP** \nID Master: T-${state.user.id.slice(-3)}\nLevel: ${state.lvl}\nProfit Harian: +${gain.toFixed(2)}% üí∞`, true); 
        }

        function sendAutonomousSignal(sym, price, type, bursa) { 
            fetch(`https://api.telegram.org/bot${OMNI.BOT_TOKEN}/sendMessage`, { 
                method: 'POST', 
                headers: {'Content-Type': 'application/json'}, 
                body: JSON.stringify({ 
                    chat_id: OMNI.GROUP_ID, 
                    text: `üöÄ **SINYAL OMNIPOTENT (L3)**\nPair: ${sym}\nStrategi: ${type}\nBursa: ${bursa}\n\n[EKSEKUSI MANUAL](${OMNI.REFF.INDODAX})`, 
                    parse_mode: 'Markdown' 
                }) 
            }); 
        }

        function sendPrivatTele(msg) { 
            fetch(`https://api.telegram.org/bot${OMNI.BOT_TOKEN}/sendMessage?chat_id=${state.user.id}&text=${encodeURIComponent(msg)}&parse_mode=Markdown`); 
        }

        function sendTele(msg, isGroup=false) { 
            const cid = isGroup ? OMNI.GROUP_ID : state.user.id;
            fetch(`https://api.telegram.org/bot${OMNI.BOT_TOKEN}/sendMessage?chat_id=${cid}&text=${encodeURIComponent(msg)}&parse_mode=Markdown`); 
        }

        // üõ†Ô∏è UTILITIES & VISUALS
        function openModal(htmlContent, showAlt = false, callback = null) { 
            document.getElementById('modal-content').innerHTML = htmlContent; 
            document.getElementById('modal-btn-alt').classList.toggle('hidden', !showAlt); 
            document.getElementById('global-modal').classList.remove('hidden'); 
            document.getElementById('modal-btn-main').onclick = () => { 
                closeModal(); 
                if(callback) callback(); 
            }; 
        }

        function closeModal() { document.getElementById('global-modal').classList.add('hidden'); }
        
        function spawnToast(msg) { 
            const toast = document.createElement('div'); 
            toast.className = 'floating-notif'; 
            toast.innerHTML = `<i class="fa-solid fa-bolt-lightning text-yellow-500"></i> <span>${msg}</span>`; 
            document.body.appendChild(toast); 
            setTimeout(() => toast.remove(), 4000); 
        }

        function alertModal(msg) { 
            openModal(`<div class='text-rose-500 font-bold uppercase tracking-widest'>${msg}</div>`); 
        }

        function updateSyncIndicator() { 
            const statusBox = document.getElementById('sync-status'); 
            if(state.L3.isLocked && state.L3.wallets[state.L3.activeWallet]?.key) { 
                statusBox.innerText = "Sync: ON"; 
                statusBox.className = "text-[9px] titan-font text-emerald-500 px-4 py-2 border border-emerald-500/20 rounded-lg bg-emerald-500/10"; 
            } else { 
                statusBox.innerText = "Sync: OFF"; 
                statusBox.className = "text-[9px] titan-font text-rose-500 px-4 py-2 border border-rose-500/20 rounded-lg bg-rose-500/5"; 
            } 
        }

        function startCamera() { 
            const video = document.getElementById('face-video'); 
            if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                navigator.mediaDevices.getUserMedia({video:true})
                .then(stream => video.srcObject = stream)
                .catch(err => console.error("Camera access denied"));
            }
        }

        function handleLogout() { 
            if(state.lvl > 1 && state['L'+state.lvl].trades.length > 0) {
                return alertModal("‚ùå SAFETY ALERT: Tutup semua posisi bursa sebelum keluar!"); 
            }
            location.reload(); 
        }

        function checkGraduation() { 
            if (Math.floor((Date.now() - state.user.joinDate)/86400000) >= 120 && state.lvl === 3) { 
                document.getElementById('cert-user-id').innerText = `MASTER-${state.user.id.slice(-3)}`; 
                document.getElementById('cert-date').innerText = new Date().toLocaleDateString('id-ID');
                document.getElementById('certificate-overlay').style.display = 'flex'; 
            } 
        }

        function drawSparkline(canvasId, priceData, strokeColor) { 
            const canvas = document.getElementById(canvasId); 
            if (!canvas) return; 
            const ctx = canvas.getContext('2d'); 
            const points = priceData.slice(-20); 
            const min = Math.min(...points); 
            const max = Math.max(...points); 
            const range = (max - min) || 1; 
            
            ctx.clearRect(0, 0, canvas.width, canvas.height); 
            ctx.beginPath(); 
            ctx.strokeStyle = strokeColor; 
            ctx.lineWidth = 2; 
            
            points.forEach((p, i) => { 
                const x = (i / (points.length - 1)) * canvas.width; 
                const y = canvas.height - ((p - min) / range) * canvas.height; 
                if(i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y); 
            }); 
            ctx.stroke(); 
        }

        function updateL2Balance() { 
            openModal(`
                <h3 class='titan-font text-xs mb-6 uppercase text-emerald-400 tracking-widest'>Sync Wallet L2 (Elite)</h3>
                <input type='number' id='sw-val' placeholder='SALDO REAL BURSA' class='w-full bg-black border border-white/10 p-6 rounded-2xl text-center mb-6 titan-font outline-none text-emerald-400'>`, 
                false, () => { 
                const val = parseFloat(document.getElementById('sw-val').value); 
                if(val >= 500000) { 
                    state.L2.equity = state.L2.initial = val; 
                    refreshUI(); 
                    spawnToast("üí∞ BALANCE L2 SYNCHRONIZED");
                } else {
                    alertModal("Minimum Sync: Rp 500.000");
                }
            }); 
        }

        function showMissionGuide() { 
            const missionData = [
                "L1 Training: Kuota 10.000. Simulasi Murni. Target 5%. Pelajari Psikologi Radar.", 
                "L2 Elite: Kuota 5.000. Real Trade Manual lewat link referral Master. Target 10%. Sinkron saldo dompet bursa.", 
                "L3 Master: Kuota 5.000. Autopilot AI penuh via API Bridge. Target 20%++. OMNIPOTENT Autonomous Mode."
            ];
            openModal(`<h3 class='titan-font text-yellow-500 mb-6 uppercase text-sm tracking-widest'>MISI LEVEL ${state.lvl}</h3><p class='text-[11px] uppercase opacity-80 leading-relaxed'>${missionData[state.lvl-1]}</p>`); 
        }
    </script>
</body>
</html>
