<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TITAN V13 - MAHADHARE GOLD ULTIMATE</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap');
        :root { --gold: #ffd700; --dark: #0a0b10; --glass: rgba(255, 255, 255, 0.05); }
        body { background: var(--dark); color: white; font-family: 'Rajdhani', sans-serif; overflow-x: hidden; }
        .font-cyber { font-family: 'Orbitron', sans-serif; }
        .glass { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1); }
        .gold-glow { text-shadow: 0 0 15px var(--gold); }
        .btn-gold { background: linear-gradient(45deg, #b8860b, #ffd700); color: black; font-weight: bold; transition: 0.3s; }
        .btn-gold:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--gold); }
        .card-animate { transition: 0.3s; cursor: pointer; }
        .card-animate:hover { border-color: var(--gold); transform: translateY(-5px); }
        #face-scan-video { border: 2px solid var(--gold); border-radius: 50%; width: 200px; height: 200px; object-fit: cover; }
        .hidden { display: none; }
    </style>
</head>
<body class="p-2 md:p-6">

    <div id="master-modal" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/90 hidden p-4">
        <div class="glass w-full max-auto p-6 rounded-2xl border-2 border-yellow-500 text-center max-w-md">
            <div id="modal-icon" class="text-5xl mb-4"></div>
            <h2 id="modal-title" class="font-cyber text-2xl text-yellow-500 mb-2"></h2>
            <p id="modal-body" class="text-gray-300 mb-6"></p>
            <button onclick="closeModal()" class="btn-gold px-8 py-2 rounded-full w-full">MENGERTI</button>
        </div>
    </div>

    <div id="auth-section" class="max-w-md mx-auto mt-10">
        <div class="text-center mb-10" onclick="secretAdminTap()">
            <i class="fa-solid fa-eye text-6xl text-yellow-500 drop-shadow-[0_0_20px_#ffd700]"></i>
            <h1 class="font-cyber text-3xl mt-4 gold-glow">TITAN V13</h1>
            <p class="text-gray-400">MAHADHARE GOLD ULTIMATE</p>
        </div>

        <div id="login-box" class="glass p-8 rounded-3xl">
            <div id="register-form" class="hidden">
                <h3 class="text-xl mb-4 text-yellow-500">Pendaftaran Member</h3>
                <input type="text" id="reg-tele" placeholder="Nomor Telegram (Contoh: 62812...)" class="w-full bg-black/50 border border-gray-700 p-3 rounded-xl mb-4 outline-none focus:border-yellow-500">
                <input type="password" id="reg-pass" placeholder="Buat Password Tinggi" class="w-full bg-black/50 border border-gray-700 p-3 rounded-xl mb-4 outline-none focus:border-yellow-500">
                <div class="flex flex-col items-center mb-4">
                    <p class="text-sm text-gray-400 mb-2">Scan Wajah Wajib</p>
                    <video id="face-scan-video" autoplay muted></video>
                </div>
                <button onclick="processRegister()" class="btn-gold w-full py-4 rounded-xl">DAFTAR SEKARANG</button>
                <p class="text-center mt-4 text-sm text-gray-400">Sudah punya akun? <span class="text-yellow-500 cursor-pointer" onclick="toggleAuth()">Login</span></p>
            </div>

            <div id="login-form">
                <h3 class="text-xl mb-4 text-yellow-500">Member Access</h3>
                <input type="text" id="log-tele" placeholder="Nomor Telegram" class="w-full bg-black/50 border border-gray-700 p-3 rounded-xl mb-4 outline-none focus:border-yellow-500">
                <input type="password" id="log-pass" placeholder="Password" class="w-full bg-black/50 border border-gray-700 p-3 rounded-xl mb-4 outline-none focus:border-yellow-500">
                <input type="text" id="log-chatid" placeholder="Chat ID Telegram" class="w-full bg-black/50 border border-gray-700 p-3 rounded-xl mb-4 outline-none focus:border-yellow-500">
                <button onclick="getChatID()" class="text-xs text-blue-400 mb-4 block underline">Belum tahu Chat ID Anda? Klik di sini</button>
                <button onclick="processLogin()" class="btn-gold w-full py-4 rounded-xl">MASUK KE NODE</button>
                <p class="text-center mt-4 text-sm text-gray-400">Baru di sini? <span class="text-yellow-500 cursor-pointer" onclick="toggleAuth()">Daftar</span></p>
            </div>
        </div>
    </div>

    <div id="main-app" class="hidden max-w-7xl mx-auto">
        <div class="flex flex-wrap justify-between items-center mb-8 gap-4">
            <div>
                <h2 class="font-cyber text-2xl text-yellow-500 gold-glow">WELCOME, <span id="user-display">MEMBER</span></h2>
                <p class="text-gray-400">Status: <span id="status-badge" class="px-2 py-1 bg-gray-700 rounded text-xs">STANDARD</span> | XP: <span id="xp-display">0</span>/150</p>
            </div>
            <div class="flex gap-3">
                <button onclick="showTutorial()" class="glass p-3 rounded-xl text-yellow-500"><i class="fa-solid fa-book"></i></button>
                <button onclick="exportExcel()" id="btn-excel" class="glass p-3 rounded-xl text-green-500 hidden"><i class="fa-solid fa-file-excel"></i></button>
                <button onclick="logout()" class="glass p-3 rounded-xl text-red-500"><i class="fa-solid fa-right-from-bracket"></i></button>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="glass p-6 rounded-3xl border-l-4 border-yellow-500">
                <p class="text-gray-400 text-sm">TOTAL EQUITY (AUTO-COMPOUND)</p>
                <h3 id="total-equity" class="text-3xl font-cyber text-yellow-500 mt-2">Rp 0</h3>
            </div>
            <div class="glass p-6 rounded-3xl border-l-4 border-blue-500">
                <p class="text-gray-400 text-sm">PROFIT TODAY (LIMIT: <span id="profit-limit">5%</span>)</p>
                <h3 id="today-profit" class="text-3xl font-cyber text-blue-500 mt-2">0%</h3>
            </div>
            <div class="glass p-6 rounded-3xl border-l-4 border-purple-500">
                <p class="text-gray-400 text-sm">EXECUTION SLOTS</p>
                <h3 id="slot-display" class="text-3xl font-cyber text-purple-500 mt-2">0/10</h3>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="glass p-6 rounded-3xl">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="font-cyber text-xl"><i class="fa-solid fa-satellite-dish text-yellow-500 mr-2"></i> RADAR MATA DEWA</h3>
                    <span class="animate-pulse text-xs text-red-500"><i class="fa-solid fa-circle"></i> AI SCANNING</span>
                </div>
                <div id="radar-list" class="space-y-4 max-h-[600px] overflow-y-auto pr-2">
                    </div>
            </div>

            <div class="glass p-6 rounded-3xl">
                <h3 class="font-cyber text-xl mb-6"><i class="fa-solid fa-bolt text-yellow-500 mr-2"></i> GUARD ROOM (TSL ACTIVE)</h3>
                <div id="execution-list" class="grid grid-cols-1 gap-4">
                    </div>
            </div>
        </div>
    </div>

    <script>
        /* CONFIGURATION DATA MASTER (PRIVATE) */
        const MASTER = {
            TELE_BOT: "8295607704:AAFdy_U8bFL-x2Ol90n8f2KDOHXztybcuj4",
            GROUP_ID: "-1003254379333",
            AID: "1319700866",
            AKEY: "MahadhareV13Master",
            LINK_INDODAX: "https://indodax.onelink.me/qyYY/referral?deep_link_value=page:register,id:marselsalmon",
            LINK_JUPITER: "https://jup.ag/?refId=yuf0dh4il1xs",
            LINK_GATE: "https://www.gate.com/referral/cashback?ref=VQUQVVWJUG"
        };

        /* STATE MANAGEMENT */
        let db = JSON.parse(localStorage.getItem('TITAN_DB')) || {
            login: false,
            tele: "",
            pass: "",
            chatID: "",
            status: "STANDARD", // STANDARD, ELITE, MASTER
            equity: 0,
            xp: 0,
            streak: 0,
            lastTradeDate: "",
            isBlocked: false,
            execution: []
        };

        let adminClicks = 0;
        let activeSignals = [];

        function save() { localStorage.setItem('TITAN_DB', JSON.stringify(db)); }

        /* SECURITY: ANTI-HACK GUARD */
        setInterval(() => {
            const before = new Date().getTime();
            debugger;
            const after = new Date().getTime();
            if (after - before > 100) {
                document.body.innerHTML = "<div class='flex items-center justify-center h-screen text-red-500 text-3xl font-cyber'>LOCKDOWN: UNAUTHORIZED INSPECTION</div>";
                db.isBlocked = true;
                save();
            }
        }, 2000);

        if (db.isBlocked) document.body.innerHTML = "<div class='flex items-center justify-center h-screen text-red-500 text-3xl font-cyber'>ACCESS PERMANENTLY DENIED</div>";

        /* PINTU BELAKANG MASTER */
        function secretAdminTap() {
            adminClicks++;
            if (navigator.vibrate) navigator.vibrate(50);
            if (adminClicks >= 5) {
                adminClicks = 0;
                db.login = true;
                db.status = 'MASTER';
                db.chatID = MASTER.AID;
                db.xp = 150;
                save();
                showModal('diamond', 'MASTER ACCESS GRANTED', 'Membuka Master Node...');
                setTimeout(() => location.reload(), 1500);
            }
        }

        /* UI CONTROLLER */
        function showModal(icon, title, body) {
            const icons = { info: 'fa-circle-info text-blue-500', success: 'fa-circle-check text-green-500', warning: 'fa-triangle-exclamation text-yellow-500', diamond: 'fa-gem text-yellow-500' };
            document.getElementById('modal-icon').innerHTML = `<i class="fa-solid ${icons[icon] || icons.info}"></i>`;
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-body').innerText = body;
            document.getElementById('master-modal').classList.remove('hidden');
        }

        function closeModal() { document.getElementById('master-modal').classList.add('hidden'); }

        function toggleAuth() {
            document.getElementById('login-form').classList.toggle('hidden');
            document.getElementById('register-form').classList.toggle('hidden');
            if (!document.getElementById('register-form').classList.contains('hidden')) startCamera();
        }

        /* AUTH LOGIC */
        function startCamera() {
            navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
                document.getElementById('face-scan-video').srcObject = stream;
            }).catch(() => showModal('warning', 'CAMERA ERROR', 'Wajib akses kamera untuk keamanan biometrik.'));
        }

        function getChatID() { window.open('https://t.me/userinfobot', '_blank'); }

        function processLogin() {
            const tele = document.getElementById('log-tele').value;
            const pass = document.getElementById('log-pass').value;
            const cid = document.getElementById('log-chatid').value;

            if (tele === MASTER.AID && pass === MASTER.AKEY) {
                db.login = true; db.status = "MASTER"; db.xp = 150; save(); location.reload(); return;
            }

            if (db.tele && tele === db.tele && pass === db.pass) {
                db.login = true; db.chatID = cid; save(); location.reload();
            } else {
                showModal('warning', 'LOGIN GAGAL', 'Password atau Nomor salah. Percobaan tercatat.');
            }
        }

        function processRegister() {
            db.tele = document.getElementById('reg-tele').value;
            db.pass = document.getElementById('reg-pass').value;
            db.equity = 1000000; // Modal awal simulasi 1 Juta
            showModal('success', 'REGISTRASI BERHASIL', 'Akun Standard Anda aktif. Silahkan login.');
            save(); toggleAuth();
        }

        /* TRADING CORE: MATA DEWA */
        async function fetchSignals() {
            // Simulasi API Indodax & Coingecko
            const coins = ['BTC', 'ETH', 'SOL', 'BNB', 'DOGE', 'PEPE', 'SHIB', 'WIF', 'JUP', 'BONK'];
            activeSignals = coins.map(c => {
                const rsi = Math.floor(Math.random() * 80) + 10;
                let type = "SCALP";
                if (rsi < 25) type = "MOONSHOT";
                else if (rsi > 60) type = "SMART";

                return {
                    coin: c,
                    price: Math.floor(Math.random() * 500000),
                    rsi: rsi,
                    strength: Math.floor(Math.random() * 30) + 70,
                    type: type
                };
            });
            renderRadar();
        }

        function renderRadar() {
            const container = document.getElementById('radar-list');
            container.innerHTML = "";
            activeSignals.forEach(s => {
                const badgeColor = s.type === "MOONSHOT" ? "bg-red-600 animate-pulse" : (s.type === "SMART" ? "bg-blue-600" : "bg-green-600");
                const html = `
                    <div class="glass p-4 rounded-2xl flex justify-between items-center card-animate border border-transparent">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-full bg-yellow-500/20 flex items-center justify-center font-bold text-yellow-500">${s.coin[0]}</div>
                            <div>
                                <h4 class="font-bold text-lg text-white">$${s.coin} <span class="text-[10px] ${badgeColor} px-2 py-0.5 rounded ml-2">${s.type}</span></h4>
                                <p class="text-xs text-gray-400">RSI: ${s.rsi} | Strength: ${s.strength}%</p>
                            </div>
                        </div>
                        <button onclick="lockSignal('${s.coin}', '${s.type}')" class="btn-gold px-4 py-2 rounded-xl text-xs">LOCK</button>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function lockSignal(coin, type) {
            if (db.execution.length >= 10) return showModal('warning', 'SLOT PENUH', 'Maksimal 10 kartu eksekusi aktif.');
            
            // Logika Pembagian Modal (10% per kartu)
            const stake = db.equity * 0.1;
            const newExecution = {
                id: Date.now(),
                coin: coin,
                type: type,
                stake: stake,
                entryPrice: 100, // Dummy
                currentPrice: 100,
                profit: 0,
                highestProfit: 0
            };

            db.execution.push(newExecution);
            save();
            updateUI();
            sendTelegram(`ðŸš¨ LOCK SIGNAL: ${coin}\nType: ${type}\nStake: Rp ${stake.toLocaleString()}\nStatus: MONITORING TSL...`);
        }

        /* AUTO-COMPOUND & TSL LOGIC */
        setInterval(() => {
            if (!db.login) return;
            db.execution.forEach(ex => {
                // Simulasi pergerakan harga
                const change = (Math.random() * 1) - 0.4; // bias naik
                ex.profit += change;
                if (ex.profit > ex.highestProfit) ex.highestProfit = ex.profit;

                // TSL Guard: 2% Drop dari titik tertinggi (Khusus Elite/Master)
                if (db.status !== "STANDARD" && ex.highestProfit > 2 && (ex.highestProfit - ex.profit) >= 2) {
                    closeTrade(ex.id, "TSL TRIGGERED");
                }
            });
            updateUI();
        }, 3000);

        function closeTrade(id, reason) {
            const index = db.execution.findIndex(e => e.id === id);
            if (index > -1) {
                const trade = db.execution[index];
                const profitRp = (trade.stake * trade.profit) / 100;
                db.equity += (trade.stake + profitRp);
                db.xp += 5;
                db.execution.splice(index, 1);
                save();
                showModal('success', 'TRADE CLOSED', `${trade.coin} ditutup: ${reason}. Profit: ${trade.profit.toFixed(2)}%`);
                sendTelegram(`âœ… PROFIT TAKEN: ${trade.coin}\nStatus: ${reason}\nEstimasi: +Rp ${profitRp.toLocaleString()}`);
            }
        }

        /* TELEGRAM INTEGRATION */
        async function sendTelegram(msg) {
            const url = `https://api.telegram.org/bot${MASTER.TELE_BOT}/sendMessage`;
            // Kirim ke Grup
            fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: MASTER.GROUP_ID, text: msg, parse_mode: 'HTML' })
            });
            // Kirim ke DM (Jika Elite/Master dan punya ChatID)
            if (db.status !== "STANDARD" && db.chatID) {
                fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: db.chatID, text: msg, parse_mode: 'HTML' })
                });
            }
        }

        /* UPDATE DASHBOARD */
        function updateUI() {
            if (!db.login) return;
            document.getElementById('auth-section').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            document.getElementById('user-display').innerText = db.tele || "ADMIN";
            document.getElementById('total-equity').innerText = `Rp ${db.equity.toLocaleString()}`;
            document.getElementById('status-badge').innerText = db.status;
            document.getElementById('xp-display').innerText = db.xp;
            document.getElementById('slot-display').innerText = `${db.execution.length}/10`;
            
            if (db.status === "ELITE" || db.status === "MASTER") {
                document.getElementById('btn-excel').classList.remove('hidden');
                document.getElementById('profit-limit').innerText = "10%";
            }

            const exeList = document.getElementById('execution-list');
            exeList.innerHTML = "";
            db.execution.forEach(ex => {
                exeList.innerHTML += `
                    <div class="glass p-4 rounded-2xl border-l-4 ${ex.profit >= 0 ? 'border-green-500' : 'border-red-500'}">
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-bold">$${ex.coin} (${ex.type})</h4>
                                <p class="text-xs text-gray-400">Stake: Rp ${ex.stake.toLocaleString()}</p>
                            </div>
                            <div class="text-right">
                                <p class="font-cyber ${ex.profit >= 0 ? 'text-green-500' : 'text-red-500'}">${ex.profit.toFixed(2)}%</p>
                                <button onclick="closeTrade(${ex.id}, 'MANUAL EXIT')" class="text-[10px] bg-red-500/20 text-red-500 px-2 py-1 rounded mt-1">EXIT</button>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        /* INITIALIZATION */
        if (db.login) {
            updateUI();
            fetchSignals();
            setInterval(fetchSignals, 8000);
        }

        function logout() {
            db.login = false;
            save();
            location.reload();
        }

        function showTutorial() {
            const content = db.status === "STANDARD" ? 
                "Misi Anda: Capai profit 5% selama 7 hari (XP 150) untuk upgrade ke Elite. Gunakan modal simulasi 1 Juta dengan bijak." :
                "Mode Elite Aktif: TSL Guard 2% mengawal profit Anda. Gunakan Link Referral Master untuk eksekusi riil di Indodax.";
            showModal('info', 'PANDUAN TITAN', content);
        }

        function exportExcel() {
            const ws = XLSX.utils.json_to_sheet([{ Aset: "BTC", Profit: "5%", Status: "Success" }]);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Reports");
            XLSX.writeFile(wb, "TITAN_REPORT.xlsx");
        }
    </script>
</body>
</html>
