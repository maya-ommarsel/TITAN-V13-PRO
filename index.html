<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TITAN V13 - MAHADHARE GOLD ULTIMATE</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Space+Grotesk:wght@300;500;700&display=swap');
        :root { --gold: #ffd700; --emerald: #10b981; --glass: rgba(10, 10, 18, 0.98); }
        body { background: #020308; color: #e2e8f0; font-family: 'Space Grotesk', sans-serif; overflow: hidden; height: 100vh; user-select: none; }
        .titan-font { font-family: 'Orbitron', sans-serif; }
        .glass-premium { background: var(--glass); backdrop-filter: blur(25px); border: 1px solid rgba(255, 215, 0, 0.15); border-radius: 1.5rem; }
        .modal-overlay { position: fixed; inset: 0; z-index: 10005; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; backdrop-filter: blur(15px); }
        .toast-premium { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 10010; background: rgba(10,10,18,0.95); border: 1px solid var(--gold); padding: 15px 25px; border-radius: 12px; animation: slideDown 0.4s ease; }
        @keyframes slideDown { from { top: -100px; } to { top: 20px; } }
        .elite-bg-glow { background: radial-gradient(circle at 50% -20%, rgba(255, 215, 0, 0.12), #020308 70%); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-[#020308]">

<div id="master-trigger" onclick="handleSecretTap()" class="fixed top-0 left-0 w-16 h-16 z-[10015] opacity-0 cursor-pointer"></div>
<div id="notif-area"></div>

<div id="auth-screen" class="fixed inset-0 z-[10000] bg-[#020308] flex flex-col items-center justify-center p-6">
    <div class="w-full max-w-sm text-center">
        <i class="fa-solid fa-crown text-5xl text-yellow-500 mb-6"></i>
        <h1 class="titan-font text-2xl text-yellow-500 mb-8 tracking-[5px] uppercase">Titan V.13</h1>
        <div class="space-y-4">
            <input type="text" id="auth-phone" placeholder="TELEGRAM CHAT ID" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 outline-none focus:border-yellow-500 text-white uppercase text-center">
            <input type="password" id="auth-pass" placeholder="PASSWORD" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 outline-none focus:border-yellow-500 text-white text-center">
            <div class="grid grid-cols-2 gap-3">
                <button onclick="handleAuth()" class="py-4 bg-yellow-500 text-black rounded-xl titan-font font-black uppercase">Login</button>
                <button onclick="toggleRegister()" class="py-4 bg-white/5 border border-white/10 text-white rounded-xl titan-font text-[10px] uppercase">Daftar</button>
            </div>
            <p class="text-[8px] text-white/40 uppercase mt-4">Hubungkan Telegram untuk Member Baru</p>
        </div>
    </div>
</div>

<header class="p-4 flex justify-between items-center bg-black border-b border-white/5 sticky top-0 z-50">
    <div class="flex items-center gap-3">
        <div class="bg-white/5 p-2 px-4 rounded-2xl flex items-center gap-2 border border-white/10">
            <div id="mode-dot" class="w-2 h-2 rounded-full"></div>
            <span id="mode-text" class="titan-font text-[9px] uppercase text-white"></span>
        </div>
        <button id="master-switch-btn" onclick="masterStatusToggle()" class="hidden bg-yellow-500/20 text-yellow-500 p-2 px-4 rounded-xl text-[9px] titan-font border border-yellow-500/30">MASTER SWITCH</button>
    </div>
    <div class="flex items-center gap-4">
        <button onclick="showTutorial()"><i class="fa-solid fa-book-open text-xl text-yellow-500"></i></button>
        <button onclick="manualLogout()"><i class="fa-solid fa-power-off text-xl text-rose-500"></i></button>
    </div>
</header>

<main class="h-full overflow-y-auto no-scrollbar pb-40">
    <section class="p-5">
        <div class="glass-premium p-6 text-center">
            <p class="text-[8px] uppercase font-black opacity-40 tracking-widest text-white/50 mb-2">Equity (Auto-Compound)</p>
            <h2 id="cap-main" class="titan-font text-4xl text-yellow-500 font-black mb-6">Rp 0</h2>
            <div class="grid grid-cols-3 gap-2">
                <div class="bg-white/5 p-3 rounded-xl border border-white/5 text-center">
                    <p class="text-[6px] opacity-40 mb-1 uppercase text-white/50">Scalp (40%)</p>
                    <p id="b-scalp" class="text-[9px] font-black text-emerald-400">Rp 0</p>
                </div>
                <div class="bg-white/5 p-3 rounded-xl border border-white/5 text-center">
                    <p class="text-[6px] opacity-40 mb-1 uppercase text-white/50">Smart (40%)</p>
                    <p id="b-smart" class="text-[9px] font-black text-blue-400">Rp 0</p>
                </div>
                <div class="bg-white/5 p-3 rounded-xl border border-white/5 text-center">
                    <p class="text-[6px] opacity-40 mb-1 uppercase text-white/50">Moon (20%)</p>
                    <p id="b-moon" class="text-[9px] font-black text-violet-400">Rp 0</p>
                </div>
            </div>
        </div>
    </section>

    <section class="px-5">
        <div class="grid grid-cols-3 gap-5">
            <div>
                <h3 class="titan-font text-[9px] text-yellow-500 mb-4 uppercase text-center font-black">Analysis</h3>
                <div id="list-analysis" class="space-y-4"></div>
            </div>
            <div>
                <h3 class="titan-font text-[9px] text-blue-500 mb-2 uppercase text-center font-black">Execution</h3>
                <div id="list-execution" class="space-y-4"></div>
            </div>
            <div>
                <h3 class="titan-font text-[9px] text-emerald-500 mb-4 uppercase text-center font-black">History</h3>
                <div id="list-history" class="space-y-3"></div>
            </div>
        </div>
    </section>
</main>

<div id="modal-vault" class="modal-overlay hidden">
    <div class="glass-premium p-10 w-full max-w-sm text-center">
        <i class="fa-solid fa-vault text-3xl text-yellow-500 mb-4"></i>
        <h3 class="titan-font text-xs text-yellow-500 mb-2 uppercase">Initial Capital</h3>
        <input type="number" id="vault-input" value="1000000" class="w-full bg-white/5 p-4 rounded-xl mb-6 titan-font text-xl text-center text-yellow-500 border border-white/10 outline-none">
        <button onclick="finalizeCapital()" class="w-full py-4 bg-yellow-500 text-black rounded-xl titan-font text-[10px] uppercase font-black">Aktifkan Engine</button>
    </div>
</div>

<script>
(function() {
    const SECRETS = {
        BT: "ODI5NTYwNzcwNDpBQUZkeV9VOGJGTC14Mk9sOTBuOGYyS0RPSHp0eWJjdWo0",
        CI: "LTEwMDMyNTQzNzkzMzM=",
        MK: "TWFoYWRoYXJlVjEzTWFzdGVy",
        ADMIN_ID: "MTAwMzI1NDM3OTMzMw=="
    };
    function decode(k) { return atob(SECRETS[k]); }

    // --- STATE MANAGEMENT (DATA HISTORY AMAN) ---
    let tapCount = 0, tapTimer, autoLockTimer;
    let saved = JSON.parse(localStorage.getItem('titan_v13_stable_final_safe'));
    let state = saved || { status: 'STANDART', initCap: 0, capProfit: 0, cards: [], log: [], isMaster: false };

    function saveData() { localStorage.setItem('titan_v13_stable_final_safe', JSON.stringify(state)); }

    // --- PERBAIKAN PANDUAN (STANDART VS ELITE) ---
    window.showTutorial = function() {
        let title, body;
        if (state.status === 'ELITE') {
            title = "ELITE MASTER PROTOCOL";
            body = "1. Limit Profit 10% Harian Aktif.\n2. TSL Guard 2% Aktif Otomatis.\n3. Akses Link Referral Master Aktif.\n4. Fitur Export XLSX History Terbuka.";
        } else {
            title = "STANDART MEMBER MISSION";
            body = "1. Limit Profit Maksimal 5%.\n2. Selesaikan Misi 7 Hari untuk Lulus.\n3. Fitur TSL Guard Dinonaktifkan.\n4. Capai Target untuk Sertifikat Kelulusan.";
        }
        showModal(title, body);
    }

    // --- SISTEM LOGIN & DAFTAR MEMBER BARU ---
    window.toggleRegister = function() {
        const ph = document.getElementById('auth-phone').value;
        const ps = document.getElementById('auth-pass').value;
        if(!ph || !ps) return smartNotif("ISI ID & PASSWORD");
        
        localStorage.setItem('u_ph', ph);
        localStorage.setItem('u_ps', ps);
        smartNotif("DAFTAR BERHASIL. SILAKAN LOGIN.");
    }

    window.handleAuth = function() {
        const ph = document.getElementById('auth-phone').value;
        const ps = document.getElementById('auth-pass').value;
        
        // Cek Master
        if (ps === decode('MK')) {
            state.isMaster = true; state.status = 'ELITE';
            localStorage.setItem('master_perm_lock', 'true');
            return enterApp();
        }
        
        // Cek Member Baru/Lama
        if (ph === localStorage.getItem('u_ph') && ps === localStorage.getItem('u_ps')) {
            state.chatID = ph;
            return enterApp();
        }
        smartNotif("AKSES DITOLAK");
    }

    // --- LOGOUT MANUAL (TIDAK HAPUS DATA) ---
    window.manualLogout = function() {
        saveData();
        localStorage.removeItem('titan_active');
        location.reload();
    }

    // --- JALUR MASTER ---
    window.handleSecretTap = function() {
        tapCount++; clearTimeout(tapTimer);
        tapTimer = setTimeout(() => { tapCount = 0; }, 1500);
        if (tapCount === 5) {
            const adminCheck = prompt("ADMIN ID:");
            if (adminCheck === decode('ADMIN_ID')) {
                state.isMaster = true; state.status = 'ELITE';
                localStorage.setItem('master_perm_lock', 'true');
                smartNotif("MASTER AUTHORIZED"); enterApp();
            }
        }
    }

    // --- ENGINE & UI ---
    async function startEngine() {
        try {
            const res = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=idr&per_page=10');
            const data = await res.json();
            state.cards = data.map(c => ({
                id: c.id, name: c.symbol.toUpperCase(), price: c.current_price, status: 'ANALYSIS'
            }));
            renderUI();
        } catch (e) { console.warn("Sync..."); }
        setTimeout(startEngine, 10000);
    }

    window.handleAction = function(id) {
        const card = state.cards.find(c => c.id === id);
        const profit = (state.initCap * 0.05) * (Math.random() > 0.4 ? 1 : -1);
        state.capProfit += profit;
        state.log.unshift({ asset: card.name, profit: profit, time: new Date().toLocaleTimeString() });
        saveData(); renderUI();
    }

    function renderUI() {
        document.getElementById('cap-main').innerText = formatIDR(state.capProfit);
        document.getElementById('mode-text').innerText = `${state.status} MODE`;
        document.getElementById('mode-dot').className = `w-2 h-2 rounded-full ${state.status === 'ELITE' ? 'bg-yellow-500 animate-pulse' : 'bg-emerald-500'}`;
        document.getElementById('master-switch-btn').classList.toggle('hidden', !state.isMaster && localStorage.getItem('master_perm_lock') !== 'true');

        const aDiv = document.getElementById('list-analysis');
        aDiv.innerHTML = state.cards.map(c => `
            <div class="glass-premium p-4 mb-2 text-center">
                <p class="text-[10px] font-bold">${c.name}/IDR</p>
                <button onclick="handleAction('${c.id}')" class="mt-2 py-1 px-4 bg-yellow-500 text-black text-[8px] rounded-lg font-black">LOCK</button>
            </div>
        `).join('');

        document.getElementById('list-history').innerHTML = state.log.slice(0, 10).map(l => `
            <div class="p-2 bg-white/5 border-l-2 ${l.profit>=0?'border-emerald-500':'border-rose-500'} text-[7px] mb-1 flex justify-between">
                <span>${l.asset}</span><span>${formatIDR(l.profit)}</span>
            </div>
        `).join('');
    }

    function finalizeCapital() {
        state.initCap = parseInt(document.getElementById('vault-input').value);
        document.getElementById('modal-vault').classList.add('hidden'); saveData(); enterApp();
    }

    function enterApp() {
        document.getElementById('auth-screen').style.display = 'none';
        localStorage.setItem('titan_active', 'true');
        if(state.initCap === 0) document.getElementById('modal-vault').classList.remove('hidden');
        startEngine();
    }

    function formatIDR(v) { return "Rp " + Math.floor(v).toLocaleString('id-ID'); }
    function smartNotif(t) { const el = document.createElement('div'); el.className="toast-premium titan-font"; el.innerText = t; document.getElementById('notif-area').appendChild(el); setTimeout(()=>el.remove(), 3000); }
    function showModal(title, body) { const modal = document.createElement('div'); modal.className = "modal-overlay"; modal.innerHTML = `<div class="glass-premium p-8 w-64 text-center border-yellow-500/40"><h4 class="titan-font text-yellow-500 text-xs mb-4 uppercase underline">${title}</h4><p class="text-[8px] mb-6 opacity-60 uppercase whitespace-pre-wrap">${body}</p><button onclick="this.parentElement.parentElement.remove()" class="w-full py-3 bg-yellow-500 text-black font-black text-[9px] rounded-xl uppercase">OK</button></div>`; document.body.appendChild(modal); }

    if (localStorage.getItem('titan_active') || localStorage.getItem('master_perm_lock')) enterApp();
})();
</script>
</body>
</html>
